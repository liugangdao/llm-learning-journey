{% extends "layout.html" %}

{% block title %}é¢˜åº“ç®¡ç†{% endblock %}

{% block content %}
  <h1>ğŸ“š é¢˜åº“ç®¡ç†</h1>
    <!-- æœç´¢å’Œç­›é€‰ -->
    <form method="GET" action="/admin">
        <input type="text" name="search" placeholder="ğŸ” æœç´¢é¢˜ç›®..." value="{{ keyword }}">
        <select name="tag">
        <option value="">ğŸ“‚ ç­›é€‰æ ‡ç­¾</option>
        {% for tag in all_tags %}
            <option value="{{ tag }}" {% if tag == tag_filter %}selected{% endif %}>{{ tag }}</option>
        {% endfor %}
        </select>
        <button type="submit">ç­›é€‰</button>
        <a href="/admin">ğŸ§¹ æ¸…é™¤</a>
    </form>
  <!-- æ·»åŠ é¢˜ç›® -->
  <form action="/admin/add" method="post" style="margin-top:20px;">
    <input type="text" name="question" placeholder="é¢˜ç›®å†…å®¹" required>
    <input type="text" name="answer" placeholder="æ­£ç¡®ç­”æ¡ˆ" required>
    <input type="text" name="tags" placeholder="æ ‡ç­¾ï¼ˆè‹±æ–‡é€—å·åˆ†éš”ï¼‰">
    <button type="submit">â• æ·»åŠ é¢˜ç›®</button>
  </form>

  <hr>

  <h2>å½“å‰é¢˜åº“</h2>
   <!-- é¢˜ç›®è¡¨æ ¼ -->
   <table>
    <thead>
      <tr>
        <th>é¢˜ç›®</th>
        <th>ç­”æ¡ˆ</th>
        <th>æ ‡ç­¾</th>
        <th>æ“ä½œ</th>
      </tr>
    </thead>
    <tbody>
    {% for q in questions %}
      <tr>
        <form action="/admin/update" method="post">
          <td>
            <input type="text" name="question" value="{{ q.question }}">
          </td>
          <td>
            <input type="text" name="answer" value="{{ q.answer }}">
          </td>
          <td>
            <input type="text" name="tags" value="{{ q.tags | join(', ') }}">
          </td>
          <td>
            <input type="hidden" name="id" value="{{ q.id }}">
            <button type="submit">ğŸ’¾ ä¿å­˜</button>
        </form>
        <form action="/admin/delete" method="post" style="display:inline;">
          <input type="hidden" name="id" value="{{ q.id }}">
          <button type="submit" onclick="return confirm('ç¡®å®šåˆ é™¤è¯¥é¢˜ç›®ï¼Ÿ')">ğŸ—‘ åˆ é™¤</button>
        </form>
          </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
  <!-- åˆ†é¡µ -->
  <div class="pagination">
    {% if page > 1 %}
      <a href="/admin?page={{ page - 1 }}&search={{ keyword }}&tag={{ tag_filter }}">â¬… ä¸Šä¸€é¡µ</a>
    {% endif %}
    ç¬¬ {{ page }} / {{ pages }} é¡µ
    {% if page < pages %}
      <a href="/admin?page={{ page + 1 }}&search={{ keyword }}&tag={{ tag_filter }}">ä¸‹ä¸€é¡µ â¡</a>
    {% endif %}
  </div>
{% endblock %}
